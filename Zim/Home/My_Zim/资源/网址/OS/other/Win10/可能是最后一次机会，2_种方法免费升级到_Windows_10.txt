Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2019-12-27T01:00:01+08:00

====== 可能是最后一次机会，2 种方法免费升级到 Windows 10 ======
创建日期 星期五 27 十二月 2019

https://sspai.com/post/58067
根据微软公布的信息，十年前发布的 Windows 7 将于 2020 年 1 月14 日正式结束「扩展支持」，而与之相对的「主流支持」早在 2015 年 1 月 13 日就已经结束。相比此前 Windows XP 的生命周期，Windows 7 的生命周期并未获得延长，毕竟其继任的操作系统 Windows 10 现已成为 Windows 家族中占有率最高的操作系统。


显然，微软结束对 Windows 7 的支持之后，用户遇到的最大的问题就是安全问题，系统将无法获得安全更新，漏洞也不会在第一时间内得到修复。而在软件支持上，虽然目前的厂商还会继续支持 Windows 7，但很有可能就像 2014 年 Windows XP 结束支持那样逐步减少支持（比如现在不少浏览器以及杀毒软件都已不再支持 Windows XP）。


加上新硬件支持和 UFEI 引导问题，如果你手里仍然有运行 Windows 7 的设备，现在升级 Windows 10 就显得非常有必要了。在这篇文章中，我们就来介绍从 Windows 7 免费升级到 Windows 10 的两种方法，同时对这个过程中的常见问题进行梳理。

使用官方「易升」工具
微软提供了 Windows 7 升级至 Windows 10 的官方工具：易升。

易升可以在保留设置以及数据信息的前提下，将 Windows 7 升级到最新版本的 Windows 10，并且这个通道至今依然是「免费」的（微软并未真正关闭免费升级渠道）！

在使用易升进行升级之前，我们需要先了解下当前的 Windows 7 版本，你可以右击「我的电脑」选择「属性」来进行查看。


需要说明的是，Windows 7 免费升级至 Windows 10 仅适用于非大量授权版本。换句话说，Windows 7 企业版不在免费升级的范围内。

同时升级后的 Windows 10 版本也和其原先的 Windows 7 版本对应，Windows 7 家庭基础版和家庭高级版将被升级为 Windows 10 家用版，而 Windows 7 专业版以及 Windows 7 旗舰版则会升级为 Windows 10 专业版。

确定当前的 Windows 7 的版本可以免费升级至 Windows 10 之后，下面的步骤就是下载 易升 进行升级了。虽说易升可以实现数据保留平滑升级，考虑到依然可能存在数据丢失的情况，所以这里建议你选择通过其他方式手动备份重要数据，以免因为数据丢失造成不必要的损失。

升级步骤如下：

下载并以管理员身份运行「易升」，首先确认「微软软件许可条款」并接受。


之后「易升」会判断电脑是否兼容 Windows 10，如果显示全部正常，点击「下一步」开始下载 Windows 10 安装程序。


等全部下载完成之后就进入自动安装步骤了，这里基本上不需要做任何形式的操作，等待完成即可。


经过几次的重启，你的 Windows 7 就正式变成了 Windows 10，而且右击选择 「此电脑 > 属性」， Windows 激活上面也显示的是「已激活」。


打开资料文件夹，原先在 Windows 7系统中的存储文件资料都还在，不过有些程序可能会丢失，重新安装即可。

需要注意的是，由于升级过程其实是将 Windows 7 系统的部分文件进行了隐藏（用于还原回滚），如果遇到 C 盘空间不足的情况，打开 C 盘的磁盘清理，选择「清理系统文件」并勾选「以前的Windows 安装文件」确认即可。


通过易升将 Window 7 升级至 Windows 10 的优点是：几乎无痛升级，无需重装系统，原先的软件设置、数据资料等都可以再最大程度上得到保留，整个操作过程傻瓜易懂，符合兼容性条件的前提下无脑点击下一步即可，非常适合对电脑技术不是很精通的小白使用。

当然这种升级也存在一些缺点，比如说升级过程中可能会出现设置丢失的情况，另外这样的安装依旧基于传统 BIOS 引导模式下，无法真正发挥硬件性能，例如很有可能不支持 2TB 的硬盘，最多仅支持四个主分区等等，当然也无法开启快速启动功能。

所以如果你的动手能力更强，这里推荐使用更现代的方式升级 Windows 10，充分发挥旧硬件的性能。

用更现代的方式升级 Windows 10
在这里我们先要普及一个基本概念：为什么我说 Window 7 并非是一款「现代」操作系统？

Windows 7 并不能完整支持 BIOS 的下一代产品 UFEI，尤其是其中可以让系统更为安全的 Secure Boot。相比 BIOS，UEFI 配合 GPT 磁盘分区表有着相当多的新特性，比如说前面说的支持 2TB 以上硬盘、支持理论上无限个分区等等。

而从原理上说，由于 UEFI 无需系统自检过程，因此开机进入系统的速度可以更快，并且有备份分区表来提高分区完整性，换言之，使用 UFEI +GPT 的系统因为安全性问题崩溃的可能性大大降低。


这正是我说 Windows 7 是一款非现代操作系统的原因，而真正让 Windows 开始支持完整 UFEI +GPT 的操作系统则要等到 Windows 8，而作为后继者的 Windows 10 更为安全，性能也可以得到更全面地释放。

但之前我们是直接通过易升从 Windows 7 升级而来的 Windows 10，除了重装之外，有没有办法无损转换成 UFEI 启动 + GPT 分区表格式？

当然有。

转换 UEFI 引导
在进行一系列操作之前，我们首先需要确认自己的电脑到底是否支持 UEFI，原因是有很多电脑比较老旧，而内置 UFEI 的主板大面积上市则要到 2012 年之后，所以如果你的电脑恰好是 2012 年之前购买的，那么很有可能你不能往下操作，也就是只能采用传统的 BIOS + MBR 分区，如果你的电脑还挺新（2012 年之后购买），那么就需要进入到系统 BIOS 检查一下。

由于各家的电脑主板进入 BIOS 的方法不同，所以这里就不详细展开了，具体步骤是在电脑启动时进入 BIOS，一般上在 Boot 选项中 Boot Mode 中有 UEFI 选项即可。


下面我们回到 Windows 10 系统中，下面的操作就是通过微软官方的工具来实现 MBR 转 GPT，首先在搜索栏中输入「CMD」，再选择「以管理员身份运行」，紧接着输入以下命令：mbr2gpt /validate /allowfullos 回车。


这个命令其实就是确认磁盘是否满足转换要求，如果最后显示 Validation completed successfully 则表示可以转换。

紧接着我们使用真正的转换命令了，这里如果你的电脑只有一块硬盘，那么直接输入：mbr2gpt /convert /allowfullos 开始转换，这个过程中除了会将磁盘分区表转为 GPT，还会生成 ESP 分区以及 MSR 分区等等，最后提示为 Conversion completed successfully 或者是提示没有找到 WINRE 分区等都是表示转换全部成功。


这时候重启电脑时再重新进入 BIOS，在 Boot Mode 中改为 UFEI（或者有些 BIOS 显示为 UEFI only），如果有 CSM 相关设置，全部改为 Disabled。

保存并重启之后，启动界面不再显示原先 Windows 系统的启动页，并且启动时 logo 下面开始「转菊花」，就说明 Windows 10 已经顺利完成 UEFI +GPT 转换。可以发挥硬件的最大性能了。


在 UFEI 下重装 Windows 10 并激活
如果你觉得上面这种升级+转换的过程实在太过漫长繁琐，当然也有一劳永逸的办法：重装。当然考虑想要少花一个激活的钱来免费吃上 Windows 10 其实也并非难事，当然前提依旧是原先你有一个零售/OEM 预装的 Windows 7，并且正常激活。

当然既然重装就肯定采用 UEFI +GPT 的安装方案，所以首先肯定是确认自己的电脑是否支持 UEFI，紧接着就是下载最新的 Windows 10 v1909 的镜像，这里可以考虑使用 Windows Media Creation Tool 来下载官方最新的镜像文件。


之后就是找一个 8GB 以上 U盘，然后使用类似 rufus 这样的烧录工具，按照下图的方式将镜像烧录进去。


烧录完成之后暂时不推出 U 盘，在当前 Windows 7 系统下打开 U盘，找到在 Sources 目录下找到「gatherosstate.exe」，然后将其拷贝到桌面选择右键 ->以管理员方式运行，之后桌面就会出现生成的 GenuineTicket.xml，而这个就是后面 Windows 10 激活要用到的数字凭证，将生成的这个凭证文件拷贝到 U盘根目录中，到后面 Windows 10 激活时要用到。


之后就是备份好原先的数据重装 Windows 10，首先重启电脑进入 BIOS，直接将 boot mode 改为「UFEI」，并关闭 CSM，并从Windows 10 官方镜像中安装，需要说明的是因为是零售版本因此需要输入序列号，这里因为我们将采用数字权限激活，这里选择「我没有序列号」。


在之后的步骤中选择 Windows 10 家庭版（和原先的 Windows 7 版本对应），然后删除所有的硬盘并让系统自动生成分区即可，然后下一步等待安装完成即可。


安装完成之后就是设置部分，和此前的 Windows 10 版本相比，v1909 强制使用 Microsoft ID 登录，因此并不能直接新键本地账户，进入到桌面之后我们首先要做的就是完成激活。


使用 Win 徽标键 + R 打开运行，输入%ProgramData%\Microsoft\Windows\ClipSVC\GenuineTicket，打开对应的文件夹，之后将之前保存的 GenuineTicket.xml 复制到文件夹中后并重启电脑，这样系统就算是采用数字证书完成激活了。


和直接升级相比，采用重装 Windows 10 来完成升级有着步骤简单不繁琐，节约磁盘空间，无需等待恢复等优点，而且因为是重新安装，所以可以充分发挥硬件的性能。当然这样的安装也存在一些缺点，比如说此前的数据软件等都需要备份，安装完成之后需要重新安装或者导入数据等，另外对于从未使用过微软在线服务的用户还需要申请一个微软账号，并且在安装过程中不能生成本地账户，可能并不适合那些希望无脑操作的朋友，无论是设置还是安装都有一些门槛。

结语
总的来说，即便是到了 Windows 7 支持周期最后一个月，我们依旧可以近乎免费的形式将自己的 Windows 7 升级至 Windows 10，随着 Windows 10 进入到第五年，其无论是易用性、安全性都在逐渐增强，而原先 Windows 7 上的软件应用也都无缝的兼容支持，那么就抓住最后这一个月时间升级的 Windows 10 吧！
