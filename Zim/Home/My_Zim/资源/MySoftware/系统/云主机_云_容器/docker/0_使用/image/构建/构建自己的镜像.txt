Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2018-12-02T22:34:38+08:00

====== æ„å»ºè‡ªå·±çš„é•œåƒ ======
åˆ›å»ºæ—¥æœŸ æ˜ŸæœŸæ—¥ 02 åäºŒæœˆ 2018

ä¸¤ç§æ–¹å¼åˆ›å»ºä½ è‡ªå·±çš„ Docker åŸºæœ¬æ˜ åƒ
https://linux.cn/article-5427-1.html
ä½œè€…ï¼š Arun Pyasi è¯‘è€…ï¼š LCTT ë‚˜ì›í˜¸ | 2015-05-11 14:44   è¯„è®º: 2 æ”¶è—: 3    
æ¬¢è¿å¤§å®¶ï¼Œä»Šå¤©æˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹ docker åŸºæœ¬æ˜ åƒä»¥åŠå¦‚ä½•æ„å»ºæˆ‘ä»¬è‡ªå·±çš„ docker åŸºæœ¬æ˜ åƒã€‚Docker æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œæä¾›äº†ä¸€ä¸ªå¯ä»¥æ‰“åŒ…ã€è£…è½½å’Œè¿è¡Œä»»ä½•åº”ç”¨çš„è½»é‡çº§å®¹å™¨çš„å¼€æ”¾å¹³å°ã€‚å®ƒæ²¡æœ‰è¯­è¨€æ”¯æŒã€æ¡†æ¶å’Œæ‰“åŒ…ç³»ç»Ÿçš„é™åˆ¶ï¼Œä»å°å‹çš„å®¶ç”¨ç”µè„‘åˆ°é«˜ç«¯æœåŠ¡å™¨ï¼Œåœ¨ä½•æ—¶ä½•åœ°éƒ½å¯ä»¥è¿è¡Œã€‚è¿™ä½¿å®ƒä»¬å¯ä»¥ä¸ä¾èµ–äºç‰¹å®šè½¯ä»¶æ ˆå’Œä¾›åº”å•†ï¼Œåƒä¸€å—å—ç§¯æœ¨ä¸€æ ·éƒ¨ç½²å’Œæ‰©å±•ç½‘ç»œåº”ç”¨ã€æ•°æ®åº“å’Œåç«¯æœåŠ¡ã€‚

Docker æ˜ åƒæ˜¯ä¸å¯æ›´æ”¹çš„åªè¯»å±‚ã€‚Docker ä½¿ç”¨ Union File System åœ¨åªè¯»æ–‡ä»¶ç³»ç»Ÿä¸Šå¢åŠ å¯è¯»å†™çš„æ–‡ä»¶ç³»ç»Ÿï¼Œä½†æ‰€æœ‰æ›´æ”¹éƒ½å‘ç”Ÿåœ¨æœ€é¡¶å±‚çš„å¯å†™å±‚ï¼Œè€Œå…¶ä¸‹çš„åªè¯»æ˜ åƒä¸Šçš„åŸå§‹æ–‡ä»¶ä»ç„¶ä¸ä¼šæ”¹å˜ã€‚ç”±äºæ˜ åƒä¸ä¼šæ”¹å˜ï¼Œä¹Ÿå°±æ²¡æœ‰çŠ¶æ€ã€‚åŸºæœ¬æ˜ åƒæ˜¯æ²¡æœ‰çˆ¶ç±»çš„é‚£äº›æ˜ åƒã€‚Docker åŸºæœ¬æ˜ åƒä¸»è¦çš„å¥½å¤„æ˜¯å®ƒå…è®¸æˆ‘ä»¬æœ‰ä¸€ä¸ªç‹¬ç«‹è¿è¡Œçš„ Linux æ“ä½œç³»ç»Ÿã€‚



ä¸‹é¢æ˜¯æˆ‘ä»¬å¦‚ä½•å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„åŸºæœ¬æ˜ åƒçš„æ–¹å¼ã€‚

1. ä½¿ç”¨ Tar åˆ›å»º Docker åŸºæœ¬æ˜ åƒ
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ tar æ„å»ºæˆ‘ä»¬è‡ªå·±çš„åŸºæœ¬æ˜ åƒï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªè¿è¡Œä¸­çš„ Linux å‘è¡Œç‰ˆå¼€å§‹ï¼Œå°†å…¶æ‰“åŒ…ä¸ºåŸºæœ¬æ˜ åƒã€‚è¿™è¿‡ç¨‹å¯èƒ½ä¼šæœ‰äº›ä¸åŒï¼Œå®ƒå–å†³äºæˆ‘ä»¬æ‰“ç®—æ„å»ºçš„å‘è¡Œç‰ˆã€‚åœ¨ Debian å‘è¡Œç‰ˆä¸­ï¼Œå·²ç»é¢„å¸¦äº† debootstrapã€‚åœ¨å¼€å§‹ä¸‹é¢çš„æ­¥éª¤ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£… debootstrapã€‚debootstrap ç”¨æ¥è·å–æ„å»ºåŸºæœ¬ç³»ç»Ÿéœ€è¦çš„åŒ…ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬æ„å»ºåŸºäº Ubuntu 14.04 "Trusty" çš„æ˜ åƒã€‚è¦å®Œæˆè¿™äº›ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç»ˆç«¯æˆ–è€… shell ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚

$ sudo debootstrap trusty trusty > /dev/null
$ sudo tar -C trusty -c . | sudo docker import - trusty
ä½¿ç”¨debootstrapæ„å»ºdockeråŸºæœ¬æ˜ åƒ

ä½¿ç”¨debootstrapæ„å»ºdockeråŸºæœ¬æ˜ åƒ

ä¸Šé¢çš„å‘½ä»¤ä¸ºå½“å‰æ–‡ä»¶å¤¹åˆ›å»ºäº†ä¸€ä¸ª tar æ–‡ä»¶å¹¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºä¸­ï¼Œ"docker import - trusty" é€šè¿‡ç®¡é“ä»æ ‡å‡†è¾“å…¥ä¸­è·å–è¿™ä¸ª tar æ–‡ä»¶å¹¶æ ¹æ®å®ƒåˆ›å»ºä¸€ä¸ªåä¸º trusty çš„åŸºæœ¬æ˜ åƒã€‚ç„¶åï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å°†è¿è¡Œæ˜ åƒå†…éƒ¨çš„ä¸€æ¡æµ‹è¯•å‘½ä»¤ã€‚

$  docker run trusty cat /etc/lsb-release
Docker GitHub Repo ä¸­æœ‰ä¸€äº›å…è®¸æˆ‘ä»¬å¿«é€Ÿæ„å»ºåŸºæœ¬æ˜ åƒçš„äº‹ä¾‹è„šæœ¬.

2. ä½¿ç”¨Scratchæ„å»ºåŸºæœ¬æ˜ åƒ
åœ¨ Docker registry ä¸­ï¼Œæœ‰ä¸€ä¸ªè¢«ç§°ä¸º Scratch çš„ä½¿ç”¨ç©º tar æ–‡ä»¶æ„å»ºçš„ç‰¹æ®Šåº“ï¼š

$ tar cv --files-from /dev/null | docker import - scratch
ä½¿ç”¨scratchæ„å»ºdockeråŸºæœ¬æ˜ åƒ

ä½¿ç”¨scratchæ„å»ºdockeråŸºæœ¬æ˜ åƒ

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ˜ åƒæ„å»ºæ–°çš„å°å®¹å™¨ï¼š

FROM scratch
ADD script.sh /usr/local/bin/run.sh
CMD ["/usr/local/bin/run.sh"]
ä¸Šé¢çš„ Dockerfile æ–‡ä»¶æ¥è‡ªä¸€ä¸ªå¾ˆå°çš„æ˜ åƒã€‚è¿™é‡Œï¼Œå®ƒé¦–å…ˆä»ä¸€ä¸ªå®Œå…¨ç©ºçš„æ–‡ä»¶ç³»ç»Ÿå¼€å§‹ï¼Œç„¶åå®ƒå¤åˆ¶æ–°å»ºçš„ /usr/local/bin/run.sh ä¸º script.sh ï¼Œç„¶åè¿è¡Œè„šæœ¬ /usr/local/bin/run.shã€‚

ç»“å°¾
è¿™è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•æ„å»ºä¸€ä¸ªå¼€ç®±å³ç”¨çš„è‡ªå®šä¹‰ Docker åŸºæœ¬æ˜ åƒã€‚æ„å»ºä¸€ä¸ª docker åŸºæœ¬æ˜ åƒæ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„ä»»åŠ¡ï¼Œå› ä¸ºè¿™é‡Œæœ‰å¾ˆå¤šå·²ç»å¯ç”¨çš„åŒ…å’Œè„šæœ¬ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨é‡Œé¢å®‰è£…æƒ³è¦çš„ä¸œè¥¿ï¼Œæ„å»º docker åŸºæœ¬æ˜ åƒéå¸¸æœ‰ç”¨ã€‚å¦‚æœæœ‰ä»»ä½•ç–‘é—®ï¼Œå»ºè®®æˆ–è€…åé¦ˆï¼Œè¯·åœ¨ä¸‹é¢çš„è¯„è®ºæ¡†ä¸­å†™ä¸‹æ¥ã€‚éå¸¸æ„Ÿè°¢ï¼äº«å—å§ :-)

via: http://linoxide.com/linux-how-to/2-ways-create-docker-base-image/

ä½œè€…ï¼šArun Pyasi è¯‘è€…ï¼šictlyh æ ¡å¯¹ï¼šwxy

æœ¬æ–‡ç”± LCTT åŸåˆ›ç¿»è¯‘ï¼ŒLinuxä¸­å›½ è£èª‰æ¨å‡º

LCTT è¯‘è€…

 ë‚˜ì›í˜¸ ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ
å…±è®¡ç¿»è¯‘ï¼š 113.5 ç¯‡ | å…±è®¡è´¡çŒ®ï¼š 817 å¤©
è´¡çŒ®æ—¶é—´ï¼š2015-04-03 -> 2017-06-28
è®¿é—®æˆ‘çš„ LCTT ä¸»é¡µ | åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘
ç¼–è¯‘è‡ªï¼šhttp://linoxide.com/linux-how-to/2-ways-create-docker-base-image/%E4%BD%9C%E8%80%85ï¼š Arun Pyasi
åŸåˆ›ï¼šLCTT https://linux.cn/article-5427-1.html%E8%AF%91%E8%80%85ï¼š ë‚˜ì›í˜¸
