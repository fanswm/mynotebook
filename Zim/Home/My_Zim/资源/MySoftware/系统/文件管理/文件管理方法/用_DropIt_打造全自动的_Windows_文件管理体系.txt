Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2019-02-21T15:34:14+08:00

====== 用 DropIt 打造全自动的 Windows 文件管理体系 ======
创建日期 星期四 21 二月 2019

用 DropIt 打造全自动的 Windows 文件管理体系
2018年07月05日
沨沄极客 沨沄极客
目录
DropIt 的使用思路
快捷调用 DropIt 的两种方式
配合 IrfanView 对图片进行操作
精细化分拣文件，一个配置文件搞定
批量进行压缩加密操作
如何使用别人的配置文件
编注：本文节选自少数派付费栏目 Power+。Power+ 聚焦于效率工具和生产力技巧的挖掘，辅以对 App、数字生活方式的探讨，以每周 4 次、总计超过 300+ 期的频率更新，为你提供源源不断的生产力补给包，帮你解决具体的、直接关系到每天生活工作的痛点。

⚡️ 点此了解 Power+ 每周更新目录

文件管理里有许多琐碎的事要做，比如：

文件自动分组；
批量打包；
批量改格式；
管理安全性高的文件；
…
如果有一个全自动的文件管理工具，它能够帮你把所有的文件分门别类地放好、给重要的文件加密、还能给文件转格式，会不会迫不及待地想尝试一下？

DropIt 就是这样一款全自动工具，来看一下它如何把各种文件给瞬间归类：

将乱成一团的文件自动分类
将乱成一团的文件自动分类
这只是今天要介绍的进阶用法的示例之一。在这篇文章，我会为大家进一步介绍如何用 DropIt 管理文稿、图片、归档，形成适合自己的工作流。

DropIt 的使用思路
我们先要了解一下 DropIt 的基本组成部分：

文件（Files）：DropIt 处理的对象就是文件。可以是一个文件，也可以是一些文件、文件夹；
协议（Associations）：对文件进行的操作被称为协议。一条协议由名称、规则、操作、具体配置这 4 个部分组成。名称是指这条协议的名字；规则是适用的文件类型，以分号隔开，比如我只想对压缩包文件操作，那规则就是 *.rar;*.zip;*.7z；操作是你想对文件进行的动作，比如「重命名」「移动」等；最后是这个操作的具体配置，不同的操作有不同的配置选项；
配置文件（Profiles）：配置文件，可以看作单个协议的文件夹。我们可以通过它将协议归类，并且导出，用于分享。
最后，将文件拖到 DropIt 的图标上，就文件会根据这些协议进行相应的动作。


图中可以看到，在 DropIt 的配置文件中，协议没有先后顺序，一个文件每次只会应用一条协议，符合一条规则之后执行对应的操作，所以无法用来做工作流。

与其说它是一条生产线，倒不如说是一个分拣工具。

那么如何才能让 DropIt 发挥最大价值呢？我拿自己的例子来帮助各位扩展思路。

快捷调用 DropIt 的两种方式
作为一个效率工具，如何快捷调用它是一个重要的问题。在调用方面，DropIt 提供了 2 种方式：

将文件拖到图标上，执行：
选中文件，「右键 - 发送到 - 具体动作」。
DropIt 的默认使用方式是将文件拖动到图标上，开始进行处理。这样的处理方式很顺手，代价是 DropIt 的图标会遮挡一部分屏幕。

拖动到图标上执行
拖动到图标上执行
而在 Windows 的右键菜单中，内置了一项「发送到」功能。由于它的默认选择很少，除了「发送到桌面」以外都很鸡肋，经常被人忽视。

由于 DropIt 的操作全都是针对文件的，所以 DropIt 顺理成章地把所有配置文件都放到了右键的「发送到」菜单中。这使得 DropIt 本身不在运行时也可以正常使用它。

而另一个快捷调用 DropIt 的方法是：选中文件，「右键 - 发送到 - 具体动作」，同样可以对文件进行操作。

右键菜单执行
右键菜单执行
这个快捷菜单的出现，让 DropIt 不必长期运行，不需要开机启动，也能像使用系统自带的功能一样进行快捷操作。

DropIt 在执行命令前，会扫描一遍文件，并把即将做的操作汇报一遍。确认后才会执行。

如果你希望点击按钮后立即执行任务，可以在设置中勾选「加载好后立即开始处理」。这样就无需再次确认了。

勾选后，直接执行配置文件
勾选后，直接执行配置文件
当然，这需要你了解你创建的协议会产生什么后果，否则容易误处理文件。

配合 IrfanView 对图片进行操作
DropIt 不仅可以单独执行，还能配合其他支持命令行的软件一起使用。这里推荐一款知名命令行图片处理工具 IrfanView。DropIt 和 Irfanview 结合恰好可以帮我完成这些工作，对图片进行简单的批量处理。

下面就以批量处理图片的两个场景为例：

批量清除照片中的 EXIF 信息
批量将 PSD 文件转换为 PNG 图片
手动清除照片中的 EXIF 信息
当你在文章中需要用到一些实物照片的时候，就要注意了。

这些照片中很可能包含各种额外的 EXIF 信息，比如拍摄日期、相机型号、地理位置等信息。这些信息本身是无害的，但如果直接分享就很有可能泄露个人信息，分享之前可以先在本地将照片中的 EXIF 信息批量清除。

这里需要配合 IrfanView 这款轻量图片工具一起使用，可以在官网下载到汉化包。

至于为什么要用 IrfanView？因为它不仅是一个仅有 1.6 MB 大小的图片浏览、转换、编辑工具，它还支持各种命令行操作，IrfanView 在根目录下提供了一个 i_options.txt 文件，里面列出了所有支持的命令行选项。

如果我们只是需要分享单张照片，可以手动做下面这些操作：

用 IrfanView 打开图像。
点击「选项 - JPG 无损操作」，取消勾选 EXIF 日期 / 时间。
删去 EXIF 信息并保存。

虽然只有几个步骤，但是不能每一张照片都手动处理一遍，这样未免也太耗时了。接下来看看什么才是高效操作。

配合 DropIt 使用，批量处理图片
我们需要在 DropIt 配置文件中新增一个协议，配置如下：

名称：批量清除 EXIF 信息
规则：*.bmp;*.gif;*.hdr;*.ico;*.jpeg;*.jpg;*.png;*.psd;*.tif;*.tiff;
操作：打开方式
目标程序："C:\Program Files\IrfanView\i_view64.exe" "%File%"/jpg_rotate=(0,1,0,1,0,0,1,0)/cmdexit
说明一下最后这段命令的意思："C:\Program Files\IrfanView\i_view64.exe" 是 IrfanView 的安装目录，如果你使用的是绿色版，需要修改到它的位置。"%File%" 是 DropIt 内置的变量，意思是「不包含扩展名的文件名」，这些内置变量是可以直接选择的，不用记住。/jpg_rotate=(0,1,0,1,0,0,1,0) 是 IrfanView 的提供选项，0 和 1 分别代表不同选项的开关。第 7 项的 1 是「清除全部标记」，第 8 项的 0 是「不保留 EXIF」。其他选项的意思可以在 i_options.txt 中查到，这里不做赘述。cmdexit 是指执行完操作后，自动关闭窗口。

保存这条协议，把图片拖到 DropIt 的图标上，即可实现批量清除图片 EXIF 了。这个操作会覆盖原图，所以在尝试执行前对照片做好备份。


你可以在这里下载 清除图片 EXIF 的配置文件。

将 PSD 源文件批量转换为 PNG 图片
我负责的文章经常需要用 Photoshop 制作题图。收集到的素材有部分是 PSD 格式的，如果我希望看到一张缩略图，那么我不得不打开 Photoshop 看一眼，保存为 PNG，然后再打开另一个……很多图片转换工具仅提供图片格式之间的互相转换，比如 JPG 转 PNG、GIF 转 JPG 等。但是面对 PSD 这种格式的文件，很多图片转换工具就无能为力了。一个一个打开 PSD 再逐个保存，实在是件麻烦事。

其实配合 IrfanView，就可以把 Photoshop 的 PSD 源文件直接转换为 PNG 格式的图片。

先在 i_options.txt 文件找到图片格式转换的指令——

i_view32.exe c:test.bmp /convert=c:giftest.gif

解释一下这段代码：使用 IrfanView 工具，将 C 盘中的 test.bmp 文件转换为 giftest.gif 文件。

我把这段代码放进 DropIt 中，稍作修改，就变成了一个新的配置文件——

名称：批量转换图片格式
规则：.bmp;*.gif;*.hdr;*.ico;*.jp2;*.jpe;*.jpeg;*.jpg;*.png;*.psd;
操作：打开方式
目标程序：
"C:\Program Files\IrfanView\i_view64.exe" "%File% /convert=%ParentDir%\%FileName%.png"
最后保存配置文件即可。

这样，你就可以用 DropIt 实现批量转换图片格式功能了。无需打开 PSD 就可以将 PSD 源文件直接转为 PNG 格式的图片。


你可以在这里下载 图片转换的配置文件。

精细化分拣文件，一个配置文件搞定
在之前的《用 DropIt 管理你的所有的下载文件 | 工作日志》中提到，处理文件需要对文件做一定的分拣，比如之前提到的归档下载文件、批量删除时间较久的的文件、将特定素材放入素材库等操作。这些都是对杂乱的文件进行的大范围操作。有没有什么方法可以按照文件内容进行更精细化的分拣呢？DropIt 提供了一项「检测文件内容」的功能，非常实用。

制定符合使用习惯的分拣策略
在我工作期间，文稿的存放位置基本上是固定的。由于我将桌面设为了坚果云的同步文件夹，所以当前的工作文件都会先存放到桌面上。等到工作结束后，再将文件进行一一归类。早期我是手动将文件放进硬盘，由于我并不完全按照文件类型分类，所以要了解文件内容才能分类，文件一多还是挺费精力的。但有了 DropIt 之后这项工作就完全交给它了。

拿我这段时间经常用到的 *.md 文件举例，这些主要分为三种——写稿、改稿、派早报。那么最符合我习惯的分拣策略是「将这三种 md 文件归类到对应的文件夹，其他的 md 文件放在原处」。

所以我在一个配置文件中，制定了三条协议，只有目标位置有所不同——

名称：Markdown 文稿分类
规则：*.md;*.txt;*.doc;*.docx;*.epub;*.odt;*.pdf;*.rtf;*.tex
操作：移动
目标：
"%ParentDir%\写稿"
"%ParentDir%\改稿"
"%ParentDir%\派早报"
不过只是这样做显然会产生冲突，因为 DropIt 无从判断应该放进哪一个文件夹，所以在「规则」中还需要添加一些筛选条件。


符合直觉的筛选方法是按文件类型和文件名，但是这里需要分拣的是同类型的文件，前者是无效的。而后者需要你对每一个文档进行详细的命名，如果没有好好命名的习惯是做不到的。那应该怎么办呢？

在 DropIt 的操作中提供了一项「检测文件内容」，简直是懒人的神器。只需要在三个规则中各添加一个「写稿」「改稿」「派早报」的关键词，它在分拣时就会自动识别 Markdown 文档中的内容是否包含这几个关键词，然后将符合关键词的文件，放进指定的文件夹。

这条配置文件就制作完成了！试着运行一下这条配置文件，看看最终的效果——


在这个例子中只有 7 个测试文件，原本需要 1 分钟的时间进行手动分拣，而现在只用了 5 秒钟，在执行效率方面，高下立判。

可以说，DropIt 把我从无尽的整理工作中解脱出来，以更高的效率完成了分拣这件事。

经过测试，这项功能适用于 *.TXT;*.MD; 等纯文本文档，也支持 *.DOC;*.DOCX;*.CSV;*.PDF 这类以文字为主的文档，*.XLS 则不支持，这与 Excel 的存储形式有关。
提高特定协议的优先级
在上面这三条协议中有一个问题，不知道各位发现了没有。

在一个配置文件中可以设定多条协议来筛选文件，但 多条协议之间可能会产生冲突，比如设置 *.jpg 文件移动到子文件夹，又设置 *.jpg 文件放进压缩包。如果运行这个配置文件，它会在扫描文件阶段出现一个提示项，真正执行前让你再做一次选择。简而言之，DropIt 采用的是「一个文件一次应用一条协议」。

如何才能让某个协议优先执行呢？答案是提高优先级。当这些协议有冲突之处时，可以在配置文件中提高某条协议的优先级（右上角的星号），或是在规则一栏添加 # 和 ## 来区分文件和文件夹，变相提高了协议的优先级。如果没有指定优先级，在执行任务时也可以手动选择。

在上面这个例子中，通过三条协议完成细致的划分之后，需要 提高这三条协议的优先级，让它们优先执行。此外，还需再添加一项通用协议，让其余的 *.md 文件留在原地。这样就可以使适用范围更广，实现全自动的精细化分拣了。

提高特殊情况的优先级
提高特殊情况的优先级
这项技巧可以很方便地运用到自己的工作流中。「检测文件内容」功能的普适性非常强，即便是同类型的文档，也会多多少少带有独特的字符串。比如筛选 Word 文档时，可以用「合同」「表格」「清单」等关键词进行非常详细的筛选工作。

你可以在这里下载 一键分类少数派稿件。

批量进行压缩加密操作
压缩包是我们经常用的一种文件形式，可以将不用的文件打包为一个文件，归档存放起来。但是在几乎所有的压缩包软件中，只能实现「选中文件 - 压缩」这样的两步操作。如果我想把超过一个月的文件打包起来，是不是要先挨个查看一遍文件？如果我想把重要的工作文档加密保存，是不是需要一个一个输入密码，打包压缩？

批量压缩 & 提取所有压缩文件
在 DropIt 中，你可以很快完成这些工作，比如直接设置一项「访问时间 > 7 天」来对这些文件进行处理，或是批量对文件进行加密。

想要批量完成压缩操作，我有两种常用的方法。只需在操作中选择「压缩」，在目标文件夹输入框中输入：

%ParentDir%\%ParentDirName%.7z，将所有选中的文件打包进同一个压缩包文件。
%ParentDir%\%FileName%.7z，为每一个文件创建一个加密压缩包。
至于解压缩功能，DropIt 除了支持 7z、RAR、ZIP 等常见的压缩包格式，还支持 DMG、ISO、WIM、VHD 等多达 38 种的归档文件格式。如果有什么压缩包文件是你目前使用的解压缩软件无法打开的，不如用 DropIt 试一试。

批量加密和解密
在电脑中总有一些不愿意被人看到的文件。比如重要的身份信息、证件照片、需要保密的工作文件等。这些文件可能并不经常使用，直接放在文件夹里又很容易被 Everything 等工具直接检索到，应该如何保证这些文件的安全性呢？

DropIt 提供了两种对文件进行加密的思路，一种是传统的 7z 压缩包加密方法，另一种是安全性更高的 AES 加密法。在操作中选择「加密」，并在左侧输入密码，还可以选择「处理完成后，删除源文件」，这样就可以将加密文件安全地储存起来。


7z 的压缩加密方式与常规的压缩包无异，我通常用 7z 来归档一些不适合直接放在电脑中显示的文件。如果你需要更高的安全性，也可以选择 AES-256、RC4 等其他加密方法，使用这种加密方式时，会生成 fcrt 格式的加密文件，解密时也需要用到 DropIt 的解密操作，适用范围就小了很多，因此推荐采用 7z 的加密方式。

你可以在这里下载 加密 & 解密的配置文件，加密的默认密码为 123，可以自行在协议中进行修改。

如何使用别人的配置文件
本文提供了一些示例的配置文件，放在了每一段的结尾。如何使用这些配置文件呢？

首先找到 DropIt 的安装目录，默认位置是 C:\Program Files\DropIt\。它的配置文件存放在这个目录下的 Profiles 文件夹中，也就是 C:\Program Files\DropIt\Profiles\ 目录中，再打开 DropIt 就可以看到配置文件了。


DropIt 可以做到的事情非常多，还能使用其他软件的命令行功能作为功能上的补充，在文件管理方面是一把好手。

正如标题所言，你可以仅靠这一款工具，打造出一个全自动的文件管理体系。
https://sspai.com/post/45532
