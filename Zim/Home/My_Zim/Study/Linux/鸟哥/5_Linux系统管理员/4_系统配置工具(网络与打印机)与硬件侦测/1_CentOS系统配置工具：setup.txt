Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2017-11-22T13:40:17+08:00

====== 1 CentOS系统配置工具：setup ======
Created Wednesday 22 November 2017

1. CentOS 系统配置工具： setup
　　1.1 使用者身份验证配置
　　1.2 网络配置项目(手动配置IP与自动取得)
　　1.3 防火墙配置
　　1.4 键盘形式配置
　　1.5 系统服务的启动与否配置
　　1.6 系统时钟的时区配置
　　1.7 X 窗口介面解析度配置
 大标题的图示CentOS 系统配置工具： setup
系统配置除了使用手动的方式编辑配置档之外 (例如 /etc/inittab, /etc/fstab 等)，其实在 Red Hat 系统的 RHEL, CentOS 及 Fedora 还有提供一支综合程序来管理的，那就是 setup 这个命令的功能罗！老实说， setup 其实只有在 Red Hat 的系列才有， 在其他的 Linux distributions 并不存在，因此，鸟哥并没有很要求一定要学会这家伙的。 只不过，setup 还是挺好用的，所以我们还是来玩玩吧！

这个 setup 的处理方法非常的简单，就是利用 root 的身份下达这个命令，如果你已经使用远程操作系统的话， 记得最好切换一下语系成为英文语系 (比较不会出现边框是乱码的情况) ，结果就会出现如下的画面了。

setup 的命令运行画面示意图
图1.0、 setup 的命令运行画面示意图
如上图所示，那就是 setup 提供的各项系统配置功能。这个画面的使用方式其实在图中的最底下一行有说明了， 可以利用 [tab] 按键在三个画面中切换，使用 Run Tool 可以开始配置该项目，使用 Quit 可以离开 setup 命令。 那么上面的主菜单部分有哪些功能呢？这些配置的基本功能是这样的：

Authentication configuration：
这是与使用者身份认证有关的配置，包括本机的帐号与利用远程服务器提供的帐号来登陆本机等功能的配置；

Firewall configuration：
简单的配置 (1)防火墙与 (2)SELinux 的启动模式 (Disable, Enforcing, Permissive)。 SELinux 请参考第十七章的说明， 防火墙则请参考服务器篇的解释了。这个地方的配置比较简单， 有时候可能会让你自己搞不清楚配置值的意义。所以，还是手动处理比较妥当；

Keyboard configuration：
就是键盘按键的对应表。注意，这个配置仅与 tty 介面有关，至於 X Window 则不是以这个为配置值；

Network configuration：
配置网络参数的地方，包括 IP, network, netmask, dns 等等，不过， 还需要看完服务器篇关於网络基础的介绍后， 才能够比较了解配置值的意义啦！

System services：
其实就是第十八章提到的 ntsysv 的内容喔～亦即配置一些系统服务是否在启动时启动的地方；

Timezone configuration：
安装的时候不是可以透过全世界地图挑选时区吗？ 这个就是在安装完毕后重新选择时区的地方；

X configuration：
配置 X Window 相关的配置，例如解析度啦等等的。我们会在第二十四章再提到 X Window 方面的基础知识。
底下我们就来约略的介绍一下这些玩意儿吧！除了网络 IP 的配置外，其余的部分鸟哥会很快的带过去而已。 毕竟 setup 仅是一个统整的工具，每个配置项目其实都牵涉到各自的基础功能，那些基础功能还得要持续摸索的...


小标题的图示使用者身份验证配置
在按下了『 Authentication configuration 』项目后，会出现如下画面：

Setup 命令的使用者身份认证机制
图 1.1.1、Setup 命令的使用者身份认证机制
我们的 Linux 除了使用自己提供的使用者口令验证机制之外，还能够使用其他外部身份验证服务器所提供的各项验证功能喔。 在上面图示的左侧 User Information 的地方指的是：我们系统上的使用者可以使用什么方式对外取得帐号资讯， 也就是说，这部主机除了 /etc/passwd 的帐号之外，还能够使用其他的帐号来登陆系统的。我们支持的帐号管理服务器主要有 LDAP, NIS, Winbind 等。

至於右侧的 Authentication 则是登陆时需要提供的身份验证码 (口令) 所使用的机制为何。 在默认的情况下，我们身份验证仅参考本机的 /etc/passwd, /etc/shadow 而已，而且使用 MD5 的口令验算机制， 因此上图右侧的部分仅会有最上方两个而已。事实上，这个部分的配置主要是修改了 /etc/sysconfig/authconfig ，同时还加入了各个服务器的用户端程序配置功能哩。

你一定会问，那么什么时候可以用到这个机制呢？思考一下，如果你的网络环境是计算机教室， 你希望每个同学都能够有自己的帐号来登陆每部主机。此时，你会希望每部主机都帮同学创建同一个帐号吗？ 那如果每一个同学都想要修改口令，那就糟了！因为每部主机都得要重新修改口令才行啊！这个时候帐号管理服务器就很重要了。 他的功能有点像底下这样：

身份管理服务器的功能示意图
图 1.1.2、身份管理服务器的功能示意图
如上图所示，我 vbird 想要登陆某一部主机时，这部主机会向外要求帐号资讯，就是最上方那部服务器。 此时，你只要在最上方的服务器上将该帐号配置好，并且在每部主机都利用 NIS 或 LDAP 功能来指定身份查询的方向， 那么 vbird 就能够使用同一组帐号口令来登陆每部主机了，这样管理是否很方便呢？因为只要管理一部服务器即可嘛！ 我们在服务器篇谈到 NIS 时再来实作这个环境喔！

Tips:
其实 NIS 与 LDAP 等等的，都是一种网络通讯协议，我们可以透过网络通讯协议来进行数据的传输。 使用者帐号资讯当然也能够透过这个机制来管理罗！有兴趣的朋友请继续阅读鸟哥写的服务器篇罗～ ^_^	鸟哥的图示
小标题的图示网络配置项目(手动配置IP与自动取得)
网络其实是又可爱又麻烦的玩意儿，如果你是网络管理员，那么你必须要了解区域网络内的 IP, gateway, netmask 等参数，如果还想要连上 Internet ，那么就得要理解 DNS 代表的意义为何。如果你的单位想要拥有自己的域名， 那么架设 DNS 服务器则是不可或缺的。总之，要配置网络服务器之前，你得要先理解网络基础就是了！ 没有人愿意自己的服务器老是被攻击或者是网络问题层出不穷吧！^_^

但鸟哥这里的网络介绍仅止於当你是一部单机的 Linux 用户端，而非服务器！所以你的各项网络参数只要找到网络管理员， 或者是找到你的 ISP (Internet Service Provider) ，向他询问网络参数的取得方式以及实际的网络参数即可。 通常网络参数的取得方式在台湾常见的有底下这几种：

手动配置固定 IP ：

常见於学术网络的服务器配置、公司行号内的特定座位等。这种方式你必须要取得底下的几个参数才能够让你的 Linux 上网的：

IP
子网络遮罩(netmask)
通讯闸(gateway)
DNS 主机的 IP (通常会有两个，若记不住的话，硬背 168.95.1.1 即可)

网络参数可自动取得：

常见於 IP 分享器后端的主机，或者是利用电视线路的缆线上网 (cable modem)，或者是学校宿舍的网络环境等。 这种网络参数取得方式就被称为 dhcp ，你啥事都不需要知道，只要知道配置上网方式为 dhcp 即可。

透过 ADSL 宽带拨接：

不论你的 IP 是固定的还是每次拨接都不相同 (被称为浮动式 IP)，只要是透过宽带调制解调器『拨接上网』的，就是使用这种方式。 拨接上网虽然还是使用网络卡连接到调制解调器上，不过，系统最终会产生一个替代调制解调器的网络介面 (ppp0) ， 那个 ppp0 也是一个实体网络介面啦！
了解了网络参数的取得方法后，你还得要知道一下我们透过啥硬件连上 Internet 的呢？其实就是网络卡嘛。 目前的主流网卡为使用以太网络协议所开发出来的以太网卡 (Ethernet)，因此我们 Linux 就称呼这种网络介面为 ethN (N 为数字)。 举例来说，鸟哥的这部测试机上面有一张以太网卡，因此鸟哥这部主机的网络介面就是 eth0 罗 (第一张为 0 号开始)。

好了，那就让我们透过 setup 来配置网络吧！按下『 Network Configuration 』会出现如下画面：

setup 的网络介面选择示意图
图 1.2.1 、 setup 的网络介面选择示意图
上图中那个 eth1.bak 是系统捉错的文件，因为这个程序会跑到 /etc/sysconfig/network-scripts/ 目录下找出档名为 ifcfg-ethN 的文件内容来显示的。因为鸟哥仅有一张网卡，因此那个 eth1 不要理会他！直接点选 eth0 之后就会产生如下的画面：

网络介面的各项网络参数配置示意图
图 1.2.2 、 网络介面的各项网络参数配置示意图
上图中那个 Name 与 Device 名称最好要相同，尽量不要修改他！这里的配置是这样的：

如果你是使用手动配置的话，『 Use DHCP 』一定不能勾选，然后将底下的 Static IP, Netmask, Default gateway IP 配置值填上去即可。这三个配置值请洽你的网络管理员喔。

如果你是使用 DHCP 的自动取得 IP 方式，勾选『 Use DHCP 』后，将后面的三个配置清空，这样就配置好网络参数了；
如果你是使用 ADSL 拨接的话，那么上面的配置项目就不适用了。 你得要使用 (1)adsl-setup 来进行配置，然后再以 (2)adsl-start 来启动 ADSL 拨接， 详细的方法我们会在服务器篇再来介绍的。上面谈的都是 IP 的取得方式，并没有谈到主机名称解析的部分 (DNS)。 只有手动配置者才需要进行 DNS IP 的配置，使用 dhcp 及 adsl-start 者都不需要进行底下的动作啦！ 假设你的 DNS IP 为中华电信的 168.95.1.1 时，那就得这样配置：

[root@www ~]# vim /etc/resolv.conf
nameserver 168.95.1.1
重点是 nameserver 后面加上你的 DNS IP 即可！一切配置都妥当之后，你还得要进行一个任务，那就是重新启动网络看看罗！ 重新启动网络的方法很简单，这样做即可：

[root@www ~]# /etc/init.d/network restart
Shutting down interface eth0:               [  OK  ]
Shutting down loopback interface:           [  OK  ]
Bringing up loopback interface:             [  OK  ]
Bringing up interface eth0:                 [  OK  ]
由於网络涉及的范围相当的广泛，还包括如何进行网络除错的工作等，鸟哥将这部份写在服务器篇了，所以这里不再多费唇舌。 假设你现在已经连上 Internet 了，那么防火墙的配置则不可不知啊！底下就来谈谈。

小标题的图示防火墙配置
防火墙的认识是非常困难的，因为你必须要有很强的网络基础概念才行。CentOS 提供的这个简单的配置其实有时候反而会让我们困扰不已。基本上，这里仅是介绍『你可以这样做』，但并不代表『你必须这样做』！ 所以，有兴趣的还是得要再继续钻研网络技术喔！ ^_^。好了，在按下 Firewall configuration 后，会出现如下画面：

setup 进入防火墙配置示意图
图 1.3.1 、 setup 进入防火墙配置示意图
上图中主要出现两个部分，一个是关於 SELinux 的部分，一个则是防火墙的部分。SELinux 我们在第十七章介绍过了，这里不再浪费篇幅。 请依据你的需求配置 Enforcing, Permissive 或 Disabled 吧！(当然最好还是务必要启动 SELinux 啦！)

防火墙的部分，由於我们安装时建议不要启动防火墙， 因此上图你会看到『 Disabled 』的部分被选择了。但是由於现在你的系统已经上网了 (假设已经上网了)， 那么你务必要启动防火墙来管理网络才好。由於默认你的防火墙会开放远程主机对你的登陆连线， 因此最好使用 Customize (客户配置) 来改变配置比较好喔！按下『 Customize 』会出现如下图示：

客制化防火墙抵挡机制的示意图
图 1.3.2 、 客制化防火墙抵挡机制的示意图
这个地方不是三言两语讲的完的！包括信任装置，以及允许进入的服务器封包～很是麻烦。基本上，你只要这样想就好了：

Trusted Devices：这是信任装置， 如果你有两张网络卡，一张是 eth0 对内，一张是对外，假设是 eth1 ，那么如果你想要让 eth0 的进出封包都是为信任，那么这里就可以将 eth0 勾选。不过，要非常非常注意， 接到外部网域 (Internet) 的那张网络卡，千万不能勾选，否则大家就都能够透过那张网卡连到你的主机上！ 在默认的情况中，这里都不要选择任何介面啦！

MASQUERADE Devices：这个是『封包伪装』的功能， 亦即是进行 IP 分享器的功能啦！如果你的 Linux 主机是作为类似 IP 分享器的功能， 那么对外那张网络卡就得要启动 MASQUERADE 才行！因为我们尚未谈到网络服务器，因此这里可千万不要随意选择。 

Allow incoming：这里提到的就是各个服务的内部项目， 举例来说，你的 Linux 有提供 WWW 服务，又希望大家都能够来查阅， 那么这个时候就可以在 WWW 那个项目前面勾选啦！你要注意到的是，默认 Linux 都会开放 ssh 这个服务 (如上图)， 记得先将他取消勾选喔！因为这个 ssh 现在很容易被攻击！所以不要开放人家使用这个服务连线到你的主机上。
基本上，这个动作仅是在创建 /etc/sysconfig/iptables 这个文件而已。 而这个文件默认是不存在的 (因为我们没有启动防火墙啊！) 。这里你先有个概念即可，因为，我们未来会介绍以 shell script 的方式创建属於您自己的防火墙系统，细节我们会在服务器篇慢慢作介绍的啊！

如果你已经有网络了，记得在这个项目的配置中，於图 1.3.1 选择防火墙为『 Enable 』的状态，按下『 Customize 』进入图 1.3.2 当中取消 ssh 的勾选，最后再回到 1.3.1 当中按下『 OK 』来启动 Linux 用户端的防火墙配置吧！ 这样你的系统就具有最起码的防火墙功能罗！ ^_^

小标题的图示键盘形式配置
某些情况底下你的键盘可能会发生一些对应错误的情况，举例来说，使用的键盘并非台湾常见的 104 按键导致很多英文对应不起来。 此时你可以使用 setup 来修改喔！按下『 Keyboard configuration 』会出现如下的画面：

键盘形式选择
图 1.4.1 、键盘形式选择
其实这个文件就仅会修改 /etc/sysconfig/keyboard 啦！很简单的配置项目。

小标题的图示系统服务的启动与否配置
我们在第十八章谈过系统服务的启动与关闭， 当时介绍过 ntsysv 吧？没错～这个 System services 的项目就是会呼叫出 ntsysv 这支程序来处理服务的配置啦！详细的配置请回第十八章参考吧！这里不再浪费篇幅罗！ 因为....鸟哥实在太会碎碎念了，再加上图示，唔！好占篇幅～ @_@

小标题的图示系统时钟的时区配置
我们知道地球是圆的，所以想要看王建民在纽约投球都得要三更半夜才有办法看的到！这也就是说， 其实在同一个时间点全世界的时钟指的时间都不相同啊！我们的 Linux 是支持多国语系的国际化操作系统， 所以你可以将这部主机拿到任何地方且不需要修改系统时钟，因为系统会主动的依据你提供的时区来变化时间的。 当你将笔记本计算机带到美国纽约并且想要变更成为美国时间时，可以按下『 Timezone configuration 』的项目：

setup 的时区选择
图 1.6.1 、 setup 的时区选择
如上图所示，你在上半部画面中，可以使用键盘方向键来选择正确的位置，然后再用 [tab] 移动到 [OK] 即可！ 时区的配置，其实就是找出与 /etc/sysconfig/clock 有关的配置项目而已。实际上，上面图示出现的咚咚，就与 /usr/share/zoneinfo/ 目录内的数据有关而已。

小标题的图示X 窗口介面解析度配置
X Window System 我们会在第二十四章再来详细说明，这里仅是告知一下， 如果你想要变更你的 X 窗口介面的解析度时，就可以使用这个项目了。不过要注意的是，这个项目的运行不可以使用类似 ssh 通讯协议连线后，在远程主机上运行这个配置项目。因为这个项目的运行会产生一个新的 X 终端机在 tty7 或 tty8 上头， 因此，你如果使用远程连线机制的话，会看不到画面的啦！理解乎？

在你点选了『 X configuration 』之后，就会出现如下的图样。其中以硬件及配置两个页面较常被变更。 先来瞧瞧图示吧：

setup 的 X 解析度配置
图 1.7.1 、 setup 的 X 解析度配置
如上所示，由於窗口解析度的范围与萤幕的支持有关，因此你必须要先处理萤幕的升级频率后才能够修改窗口解析度。 所以我们会先处理『硬件』部分，鸟哥的萤幕是旧式的 4:3 传统萤幕，所以选择 1024x768 ，如果你的萤幕是新型的宽萤幕， 那么请自行挑选适当的解析度吧。处理完毕后就能够开始配置窗口解析度了，如下所示：

setup 的 X 解析度配置
图 1.7.2 、 setup 的 X 解析度配置
如上图所示，此时会出现可调整的解析度啦！整理整理就能够显示出你想要的窗口解析度。 其实这些配置都是修改 /etc/X11/xorg.conf 这个配置档啦！等到了第二十四章时，我们再来详细的谈谈这玩意吧！ 至於关於 X 方面的登录文件则在 /var/log/Xorg.0.log 罗！

鸟哥个人认为，这个 setup 的工具是很好用的～只是，如果能够完全清楚整个系统架构的话， 再来玩这个小程序会比较好啦！ ^_^。另外，原本的旧版 CentOS 还有提供打印机的配置功能，不过由於新版的数据已经转由 CUPS 负责列印， 而列印可以使用浏览器介面来显示，因此就取消了这个 setup 的组件啦！底下我们就来玩玩如何简单的配置你的打印机吧！
