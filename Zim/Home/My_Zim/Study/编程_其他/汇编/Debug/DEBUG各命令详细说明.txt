Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.4
Creation-Date: 2018-12-31T22:16:58+08:00

====== DEBUG各命令详细说明 ======
Created Monday 31 December 2018

https://blog.csdn.net/liuer2004_82/article/details/52638516
启动DEBUG
1.打开Windows命令窗口
在Windows 95/98的环境中，打开命令窗口的步骤为：点击“开始”→“运行”，输入“command”命令； 
在WindowsXP及WIN7的环境中，打开命令窗口的步骤为：点击“开始”→“运行”，输入“cmd”命令；

2.启动DEBUG
在命令窗口中启动DEBUG，启动命令一般为：DEBUG  [文件名] [参数表]。其中：文件名指定被调试的文件，其包括名和后缀，参数表是被调试文件运行时所需要的参数。被调试的文件可以是系统中的任何文件，但通常它们的 后缀为.EXE或.COM。 当DEBUG启动成功后，将显示连接符“-”，这时，可输入各种DEBUG命令。DEBUG中所有命令及其含义如DEBUG各命令功能说明表 所示。 关于使用命令的几点说明：在提示符“-”下才能输入命令，在按“回车”键后，该命令才开始执行命令是单个字母，命令和参数的大小写可混合输入可用F1、 F2、F3、Ins、Del、左移键、右移键等编辑键来编辑本行命令当命令出现语法错误时，将在出错位置显示“^ Error”可用Ctrl+C或Ctrl+Break来终止当前命令的执行，还可用Ctrl+S或Ctrl+Num Lock来暂停屏幕显示(当连续不断地显示信息时)
以下通过实现十九个示例来熟悉DEBUG的命令集和基本的汇编指令。
R命令的使用
__R命令作用：观看和修改寄存器的值。__
在提示符“-”下输入以下命令：R。DEBUG将会显示出当前所有寄存器和标志位的状态。
接下来再输入命令RCX。在提示符“：”后输入100。该命令的作用是将寄存器CX的值设置为100（注意：DEBUG使用的是十六进制，这里的100相当于十进制的256。）
最后再执行R命令，观看修改后的寄存器值。
H命令的使用
__H命令作用：计算两个十六进制数的和与差。__
在提示符“–”下输入以下命令：H 10 1。观看命令执行结果。
运行结果的__前一个数是计算出来的和，后一个数是计算出来的差__。计算结果均用十六进制形式表示。
D命令的使用
__D命令作用：显示内存区域的内容__。
在提示符“–”下连续执行命令R、D、D。观看命令执行结果。
前面已经介绍过了，命令R的作用是显示当前寄存器的值。而命令D的作用是显示内存区域的内容，最左边是内存的起始地址，中间以十六进制的形式显示内存值，最右边是以ASCII码的形式显示内存值。每行最多显示16个字节的内容。
命令D可以带参数也可省略参数。设DEBUG启动时DS的值为X，当省略参数时，命令D显示内容以X：100为起始，每次显示128个字节的内容。以后再执行不带参数的命令D时，DEBUG将按上次的位置接着显示下去。
带参数时DEBUG能够显示指定地址范围的内容。带参数的方式有三种：
方式一：d [起始位置]。DEBUG从起始位置开始显示128个字节的内容。在提示符“-”下执行命令D 1AF5:100。观看命令执行结果。
方式二：d [起始位置] [结束位置]。DEBUG从起始位置开始一直显示到结束位置。在提示符“-”下执行命令D DS:100 1FF。观看命令执行结果。
方式三：d [起始位置] [L长度]，长度以L参数为标识。DEBUG从起始位置开始显示指定长度的内容。在提示符“-”下执行命令D DS:100 L10。观看命令执行结果。
E命令的使用
__E命令作用：改变内存单位的内容。__
E命令的使用方式为：E [起始位置]。
在提示符“-”下输入以下命令：E 1AF5:100。
DEBUG首先显示[1AF5:0000]的内容00.，这时可以修改该字节的值。如果还要修改后续的内容，可以按空格键继续。当要跳过某个字节时，可以按连续的两个空格跳到后一个字节去。
F命令的使用
__F命令作用：使用指定的值填充指定内存区域中的地址。__
F命令的使用方式为：F [范围] [填充列表]。
在提示符“-”下输入以下命令：F 1AF5:100 L20 1 2 3 4 5。执行命令D 1AF5:100观看命令执行结果。
说明：该命令是用字节序列01、02、03、04、05轮流填充从1AF5:100开始长度为20H的内存区域。
在提示符“-”下输入以下命令：F 1AF5:100 13F 41 42 43 44。
说明：该命令是用字节序列41、42、43、44轮流填充从1AF5:100开始一直到1AF5:13F的内存区域。
M命令的使用
__M命令作用：将指定内存区域的数据复制到指定的地址去。__
M命令的使用方式为：M [范围] [指定地址]。
在提示符“-”下输入以下命令：M 1AF5:100 13F 1AF5:140。执行命令D 1AF5:100观看命令执行结果。
C命令的使用
__C命令作用：将两块内存的内容进行比较。__
C命令的使用方式为：C [范围] [指定地址]，意思就是将指定范围的内存区域与从指定地址开始的相同长度的内存区域逐个字节进行比较，列出不同的内容。
在提示符“-”下输入以下命令：C 1AF5:100 13F 1AF5:140。由于两块内容完全相同，所以命令执行后没有任何显示。
在提示符“-”下输入以下命令：C 1AF5:100 107 1AF5:180，比较的区域长度为8个字节。命令执行后列出比较结果不同的各个字节。
S命令的使用
__S命令作用：在指定的内存区域中搜索指定的串。__
S命令的使用方式为：S [范围] [指定串]。
在提示符“-”下输入以下命令：D 1AF5:100 11F。显示该区域的内存值。
在提示符“-”下输入以下命令：S 1AF5:100 11F 41 42 43 44。搜索该区域是否存在字节串41 42 43 44，并将搜索结果一一列出。
从执行结果可以看出，总共搜索到八处。
A命令的使用
__A命令作用：输入汇编指令。以汇编指令的形式在内存中写入机器 指令。__
以下的程序要在屏幕上显示“ABCD”四个字符。
首先用E命令将“ABCD$”四个字符预先放在内存CS:200处，然后执行A100命令输入汇编程序代码：
MOV AX,CS
MOV DS,AX
MOV DX,200
MOV AH,9
INT 21
INT 20
（说明：前两行汇编指令用于将段寄存器CS的值赋给段寄存器DS。第三到第五行汇编代码的作用是显示以“$”为结尾的字符串。最后一行用于结束程序。
G命令的使用
__G命令作用：执行汇编指令__。
G命令的使用方法是：G [=起始地址]  [断点地址]，意思是从起始地址开始执行到断点地址。如果不设置断点，则程序一直运行到中止指令才停止。
在设置完示例九的的内存数据并且输入完示例九的程序后运行这些汇编代码。在DEBUG中执行命令G=100，观看运行结果。
汇编程序运行后在屏幕上显示出“ABCD”四个字符。
接下来在DEBUG中执行G=100 10B，意思是从地址CS：100开始，一直运行到CS：10B停止。观看运行结果。
命令执行后，不但显示出字符串“ABCD”，而且列出当前寄存器和标志位的值。
U命令的使用
__U命令作用：对机器代码反汇编显示__。
U命令的使用方法是：U [范围]。如果范围参数只输入了起始地址，则只对20H个字节的机器代码反汇编。执行命令U100，观看反汇编结果。
执行命令U100 10B，观看反汇编结果。该命令的作用是对从100到10B的机器代码进行反汇编。
N命令的使用
__N命令作用：设置文件名，为将刚才编写的汇编程序存盘做准备。__
以下的DEBUG命令序列作用将刚才的汇编程序存为磁盘的COM可执行程序。
D200 20F
U100 10C
N  E:\FIRST.COM
RCX
:110
W
第一和第二条命令的作用是检查一下刚才编写的汇编指令。第三条命令的作用是设置存盘文件名为E:\FIRST.COM，第四条命令的作用是设置存盘文件大小为110H个字节。最后一条命令是将文件存盘。
文件存盘后执行E:\FIRST.COM，观看存盘的可执行文件的运行效果。
W命令的使用
__W命令作用：将文件或者特定扇区写入磁盘。__
在示例“N命令的使用”中已经实验了如何使用W命令将文件存盘。
在没有很好地掌握汇编语言和磁盘文件系统前，暂时不要使用W命令写磁盘扇区，否则很容易损坏磁盘文件，甚至破坏整个磁盘的文件系统。
L命令的使用
__L命令作用：从磁盘中将文件或扇区内容读入内存。__
将文件调入内存必须先用DEBUG的N命令设定文件名。以下例子是将E:\FIRST.COM读入内容。
N FIRST.COM
L
观看调入程序的汇编代码可以使用DEBUG的U命令，用U100观看调入的COM文件。
读取磁盘扇区的方式是：L [内存地址] [磁盘驱动器号] [起始扇区] [扇区数]。“内存地址”指定要在其中加载文件或扇区内容的内存位置，如果不指定“内存地址”的话，DEBUG将使用CS寄存器中的当前地址。“磁盘驱动器号”指定包含读取指定扇区的磁盘的驱动器，该值是数值型：0=A，1=B，2=C等。“起始扇区”指定要加载其内容的第一个扇区的十六进制数。“扇区数”指定要加载其内容的连续扇区的十六进制数。
只有要加载特定扇区的内容而不是加载文件时，才能使用[磁盘驱动器号] [起始扇区] [扇区数]参数。
例如：要将C盘第一扇区读取到内存DS:300的位置，相应的DEBUG命令为L DS:300 2 1 1。但是由于Windows操作系统对文件系统的保护，这条命令可能会被操作系统禁止运行。
T命令的使用
__T命令作用：执行汇编程序，单步跟踪。__
T命令的使用方式是T [=地址] [指令数]。如果忽略“地址”的话，T命令从CS:IP处开始运行。“指令数”是要单步执行的指令的数量。
以下示例对E:\FIRST.COM进行单步跟踪。
N E:\FIRST.COM
L
U100 10B
R
T=100
T
第一、二条命令是装入文件，第三条命令是列出程序反汇编代码，第四条命令是显示当前寄存器值，第五条命令是从CS:100处开始单步跟踪，第六条命令是继续跟踪后续的指令。
P命令的使用
__P命令作用：执行汇编程序，单步跟踪。与T命令不同的是：P命令不会跟踪进入子程序或软中断。__
P命令的使用方式与T命令的使用方式完全相同。
I命令的使用
__I命令作用：从计算机输入端口读取数据并显示。__
I命令的用法是I [端口地址]。例如从3F8号端口读取数据并显示的命令为：I 3F8。这里不对该命令做解释。
O命令的使用
__O命令作用：向计算机输出端口送出数据。__
O命令的用法是O [端口地址] [字节值]。例如向278号端口发出数据20H的命令为：I 278 20。这里不对该命令做解释。
Q命令的使用
__Q命令的作用是退出DEBUG，回到DOS状态。__
