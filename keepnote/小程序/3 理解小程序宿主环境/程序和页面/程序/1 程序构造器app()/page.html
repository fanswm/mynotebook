<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>1 程序构造器App()</title>
</head><body>1.<span style="color: #ff0000">&nbsp;程序构造器App()<br/>
</span><br/>
宿主环境提供了 App() 构造器用来注册一个程序App，需要留意的是<span style="color: #ff0000">App() 构造器必须写在项目根目录的app.js里</span>，App实例是单例对象，在其他JS脚本中可以使用宿主环境提供的 getApp() 来获取程序实例。<br/>
<br/>
代码清单3-3 getApp() 获取App实例<br/>
<br/>
// other.js<br/>
var appInstance = getApp()<br/>
<br/>
App() 的调用方式如代码清单3-4所示，<span style="color: #ff0000">App构造器接受一个Object参数，参数说明如表3-1所示</span>，其中onLaunch / onShow / onHide 三个回调是App实例的生命周期函数，我们会在后文展开；onError我们暂时不在本章展开，我们会在第8章里详细讨论；App的其他参数我们也放在后文进行展开。<br/>
<br/>
代码清单3-4 App构造器<br/>
<br/>
App({<br/>
&nbsp;<span style="color: #ff0000">&nbsp;onLaunch: function(options) {},<br/>
</span><span style="color: #ff0000">&nbsp; onShow: function(options) {},<br/>
&nbsp; onHide: function() {},<br/>
&nbsp; onError: function(msg) {},<br/>
</span><span style="color: #ff0000">&nbsp; globalData: 'I am global data'</span><br/>
})<br/>
<br/>
表3-1 App构造器的参数<br/>
<br/>
参数属性&#09;&#09;类型&#09;&#09;描述<br/>
<br/>
onLaunch&#09;Function&#09;当小程序初始化完成时，会触发 onLaunch<span style="color: #ff0000">（全局只触发一次）</span><br/>
onShow&#09;&#09;Function&#09;当小程序启动，或从后台进入前台显示，会触发 onShow<br/>
onHide&#09;&#09;Function&#09;当小程序从前台进入后台，会触发 onHide<br/>
onError&#09;&#09;Function&#09;当小程序发生脚本错误，或者 API 调用失败时，会触发 onError 并带上错误信息<br/>
其他字段 　&#09;任意&#09;&#09;可以添加任意的函数或数据到 Object 参数中，在App实例<span style="color: #ff0000">回调用 this 可以访问</span><br/>
</body></html>